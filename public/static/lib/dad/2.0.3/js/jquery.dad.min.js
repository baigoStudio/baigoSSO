!function(h){"use strict";var u={};function o(){this.positionX=0,this.positionY=0,this.offsetX=0,this.offsetY=0}function e(t,e){this.options=this.parseOptions(e),this.$container=h(t),this.$current=null,this.$target=null,this.$clone=null,this.mouse=new o,this.holding=!1,this.dragging=!1,this.dropzones=[],this.setActive(this.options.active),this.setup()}u.supportsTouch="ontouchstart"in window||navigator.msMaxTouchPoints,u.shouldScroll=!0,u.supportsTouch&&document.addEventListener("touchmove",function(t){u.shouldScroll||t.preventDefault()},{passive:!1}),e.defaultOptions={active:!0,draggable:!(o.prototype.update=function(t){var e,o;u.supportsTouch&&"touchmove"==t.type?(e=t.originalEvent.touches[0],o=document.elementFromPoint(e.clientX,e.clientY),h(o).trigger("touchenter"),this.positionX=e.pageX,this.positionY=e.pageY):(this.positionX=t.pageX,this.positionY=t.pageY)}),exchangeable:!0,placeholderTarget:!1,placeholderTemplate:"<div />",placeholderClass:"dad-placeholder",targetClass:"dad-target",cloneClass:"dad-clone",transition:200},e.prototype.parseOptions=function(i){var s=h.extend(!0,{},e.defaultOptions);return i&&h.each(s,function(t,e){var o=i[t];void 0!==o&&(s[t]="object"==typeof o?h.extend(s[t],o):o)}),s},e.prototype.setup=function(){var s=this;this.$container.css({position:"relative","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}),this.$container.find("img").attr("ondragstart","return false"),this.$container.on("mouseenter touchenter",function(t){var e,o,i;s.$current&&(o=!(e=h(this)).is(s.$current),i=s.options.exchangeable,s.dragging&&o&&i&&s.updatePlaceholder(t,e,!0))}),this.$container.on("mousedown touchstart","> *",function(t){var e=h(this);s.prepare(t,e)}),this.$container.on("mouseenter touchenter","> *",function(t){var e,o,i;s.$current&&(e=h(this),o=!!s.$current.find(this).length,i=s.options.exchangeable,s.dragging&&(o||i)&&s.updatePlaceholder(t,e))}),h("body").on("mousemove touchmove",this.update.bind(this)),h("body").on("mouseup touchend",this.end.bind(this)),h("body").on("mouseleave",this.end.bind(this)),h(window).on("blur",this.end.bind(this))},e.prototype.prepare=function(t,e){var o=this.options.draggable,i=o&&h(o);this.active&&(!i||(i.is(t.target)||i.find(t.target).length))&&(this.holding=!0,this.$target=e,this.$current=e.closest(this.$container),this.mouse.update(t))},e.prototype.start=function(t){var e=this.options,o=this.$target,i=this.$current,s=o.clone().css({position:"absolute",zIndex:9999,pointerEvents:"none",height:o.outerHeight(),width:o.outerWidth()}),n=h(e.placeholderTemplate).css({position:"absolute",pointerEvents:"none",zIndex:9998,margin:0,padding:0,height:o.outerHeight(),width:o.outerWidth()});this.mouse.offsetX=this.mouse.positionX-o.offset().left,this.mouse.offsetY=this.mouse.positionY-o.offset().top,o.css("visibility","hidden"),o.addClass(e.targetClass),s.addClass(e.cloneClass),n.addClass(e.placeholderClass),u.supportsTouch&&(u.shouldScroll=!1),this.dragging=!0,this.$target=o,this.$clone=s,this.$placeholder=n,i.append(n).append(s),this.updateClonePosition(),this.updatePlaceholderPosition(),h(i).trigger("dadDragStart",[o[0]])},e.prototype.update=function(t){this.mouse.update(t),this.holding&&!this.dragging&&this.start(t),this.dragging&&this.updateClonePosition()},e.prototype.end=function(t){var e,o,i,s,n,r,a;this.holding=!1,this.dragging&&(u.supportsTouch&&(u.shouldScroll=!0),e=this.options,o=this.$current,i=this.$target,s=this.$clone,n=this.$placeholder,r=i.offset().left-this.getContainerX(),a=i.offset().top-this.getContainerY(),h(o).trigger("dadDragEnd",[i[0]]),s.animate({top:a,left:r,height:i.outerHeight(),width:i.outerWidth()},this.options.transition,function(){s.remove(),n.remove(),i.removeClass(e.targetClass),i.css("visibility",""),h(o).trigger("dadDrop",[i[0]])}),this.dragging=!1,this.$current=null,this.$target=null,this.$clone=null,this.$placeholder=null)},e.prototype.getContainerX=function(){return this.$current.offset().left-this.$current.scrollLeft()},e.prototype.getContainerY=function(){return this.$current.offset().top-this.$current.scrollTop()},e.prototype.updateClonePosition=function(){var t=this.mouse.positionX-this.getContainerX()-this.mouse.offsetX,e=this.mouse.positionY-this.getContainerY()-this.mouse.offsetY;this.$clone.css({top:e,left:t})},e.prototype.updatePlaceholder=function(t,e,o){var i=this.$current,s=this.$target,n=this.$clone,r=this.$placeholder;o?(e.append(s),e.append(n),e.append(r),this.$current=e,h(i).trigger("dadDragExchange",[i[0],e[0]])):(e.index()>s.index()?e.after(s):e.before(s),h(i).trigger("dadDragUpdate",[s[0]])),this.updatePlaceholderPosition()},e.prototype.updatePlaceholderPosition=function(){var t=this.options.placeholderTarget,e=t?this.$target.find(t):this.$target,o=e.offset().top-this.getContainerY(),i=e.offset().left-this.getContainerX(),s=e.outerHeight(),n=e.outerWidth();this.$placeholder.css({top:o,left:i,width:n,height:s})},e.prototype.onDrop=function(t,e){h(t).on("mouseenter touchenter",function(t){h(this).attr("data-dad-active",!0)})},e.prototype.setActive=function(t){this.active=t,this.$container.attr("data-dad-active",t)},e.prototype.activate=function(){this.setActive(!0)},e.prototype.deactivate=function(){this.setActive(!1)},h.fn.dad=function(t){return new e(this,t)}}(jQuery);